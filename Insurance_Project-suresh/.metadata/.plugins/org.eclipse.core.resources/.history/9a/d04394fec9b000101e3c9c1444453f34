package com.support.config;

public class SecurityConfig {
	private final JwtAuthFilter jwtAuthFilter;


	public SecurityConfig(JwtAuthFilter jwtAuthFilter) {
	this.jwtAuthFilter = jwtAuthFilter;
	}


	@Bean
	public SecurityFilterChain securityFilterChain(HttpSecurity http) throws Exception {
	http.csrf().disable()
	.authorizeHttpRequests()
	.requestMatchers("/api/auth/**", "/swagger-ui/**", "/v3/api-docs/**").permitAll()
	.anyRequest().authenticated()
	.and()
	.sessionManagement().sessionCreationPolicy(SessionCreationPolicy.STATELESS);


	http.addFilterBefore(jwtAuthFilter, UsernamePasswordAuthenticationFilter.class);
	return http.build();
	}


	@Bean
	public AuthenticationManager authenticationManager(AuthenticationConfiguration config) throws Exception {
	return config.getAuthenticationManager();
	}
}
