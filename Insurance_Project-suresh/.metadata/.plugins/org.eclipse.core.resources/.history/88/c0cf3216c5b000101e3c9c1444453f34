package com.support.config;

import org.springframework.stereotype.Component;
import org.springframework.web.filter.OncePerRequestFilter;
@Component
public class JwtAuthFilter extends OncePerRequestFilter{
	private final JwtUtil jwtUtil;


	public JwtAuthFilter(JwtUtil jwtUtil) {
	this.jwtUtil = jwtUtil;
	}


	@Override
	protected void doFilterInternal(HttpServletRequest request, HttpServletResponse response, FilterChain filterChain)
	throws ServletException, IOException {


	String header = request.getHeader("Authorization");
	if (header != null && header.startsWith("Bearer ")) {
	String token = header.substring(7);
	if (jwtUtil.validateToken(token)) {
	SecurityContextHolder.getContext().setAuthentication(jwtUtil.getAuthentication(token));
	}
	}
	filterChain.doFilter(request, response);
	}
}
