package com.support.util;

import org.springframework.stereotype.Component;

@Component
public class JwtUtil {
	private final Key key = Keys.secretKeyFor(SignatureAlgorithm.HS256);


	public String generateToken(String username) {
	return Jwts.builder()
	.setSubject(username)
	.signWith(key)
	.compact();
	}


	public boolean validateToken(String token) {
	try {
	Jwts.parserBuilder().setSigningKey(key).build().parseClaimsJws(token);
	return true;
	} catch (JwtException e) {
	return false;
	}
	}


	public Authentication getAuthentication(String token) {
	String username = Jwts.parserBuilder().setSigningKey(key).build().parseClaimsJws(token).getBody().getSubject();
	return new UsernamePasswordAuthenticationToken(username, null, Collections.emptyList());
	}
}
